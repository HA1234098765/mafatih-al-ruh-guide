<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ø­Ø³Ù†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .test-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }

        .test-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.3s ease;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .result-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid #e1e8ed;
            display: none;
        }

        .result-container.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .verse-display {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #dee2e6;
        }

        .verse-arabic {
            font-size: 1.8rem;
            line-height: 2.2;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .verse-reference {
            color: #7f8c8d;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .analysis-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            text-align: center;
        }

        .analysis-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .status-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 5px;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .log-container {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .log-success { color: #2ecc71; }
        .log-warning { color: #f39c12; }
        .log-error { color: #e74c3c; }
        .log-info { color: #3498db; }

        .quick-tests {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .confidence-bar {
            width: 100%;
            height: 20px;
            background: #e1e8ed;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c 0%, #f39c12 50%, #27ae60 100%);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ø­Ø³Ù†</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±</p>
        </div>

        <div class="content">
            <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… -->
            <div class="test-section">
                <h2>ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>Ø®Ø¯Ù…Ø© Groq AI</h4>
                        <div id="groq-status" class="status-indicator status-warning">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
                    </div>
                    <div class="analysis-card">
                        <h4>Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠØ©</h4>
                        <div id="verse-status" class="status-indicator status-warning">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
                    </div>
                    <div class="analysis-card">
                        <h4>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±</h4>
                        <div id="sentiment-status" class="status-indicator status-warning">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
                    </div>
                </div>
                <button class="btn btn-success" onclick="checkSystemHealth()">ğŸ”„ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</button>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
            <div class="test-section">
                <h2>âš¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h2>
                <div class="quick-tests">
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø­Ø²Ù† Ø§Ù„Ø´Ø¯ÙŠØ¯')">ğŸ˜¢ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ø²Ù†</button>
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ù‚Ù„Ù‚ ÙˆØ§Ù„ØªÙˆØªØ±')">ğŸ˜° Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù‚Ù„Ù‚</button>
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„Ø§Ù…ØªÙ†Ø§Ù†')">ğŸ˜Š Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´ÙƒØ±</button>
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø¶ÙŠØ§Ø¹ ÙˆØ¹Ø¯Ù… Ø§Ù„ÙŠÙ‚ÙŠÙ†')">ğŸ¤” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¶ÙŠØ§Ø¹</button>
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© ÙˆØ§Ù„ÙØ±Ø­')">ğŸ˜„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø¹Ø§Ø¯Ø©</button>
                    <button class="btn" onclick="quickTest('Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„ØºØ¶Ø¨ ÙˆØ§Ù„Ø¥Ø­Ø¨Ø§Ø·')">ğŸ˜  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØºØ¶Ø¨</button>
                </div>
            </div>

            <!-- Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø®ØµØµ -->
            <div class="test-section">
                <h2>ğŸ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø®ØµØµ</h2>
                <div class="input-group">
                    <label for="customMood">Ø£Ø¯Ø®Ù„ Ø­Ø§Ù„ØªÙƒ Ø§Ù„Ù†ÙØ³ÙŠØ©:</label>
                    <textarea 
                        id="customMood" 
                        placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ ÙƒÙŠÙ ØªØ´Ø¹Ø± Ø¨Ø§Ù„ØªÙØµÙŠÙ„... Ù…Ø«Ø§Ù„: Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø­Ø²Ù† Ø¨Ø³Ø¨Ø¨ ÙÙ‚Ø¯Ø§Ù† Ø¹Ø²ÙŠØ² Ø¹Ù„ÙŠØŒ ÙˆØ£Ø­ØªØ§Ø¬ Ù„Ù„Ø³Ù„ÙˆØ§Ù† ÙˆØ§Ù„ØµØ¨Ø±"
                    ></textarea>
                </div>
                <button class="btn btn-success" onclick="testCustomMood()" id="testBtn">
                    ğŸš€ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©
                </button>
                <button class="btn btn-warning" onclick="testSentimentOnly()">
                    ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± ÙÙ‚Ø·
                </button>
            </div>

            <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
            <div id="results" class="result-container">
                <h3>ğŸ“‹ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                
                <!-- ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± -->
                <div id="sentiment-analysis" style="display: none;">
                    <h4>ğŸ§  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±</h4>
                    <div class="analysis-grid">
                        <div class="analysis-card">
                            <h4>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±</h4>
                            <div id="sentiment-type"></div>
                        </div>
                        <div class="analysis-card">
                            <h4>Ø´Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ø¹Ø±</h4>
                            <div id="sentiment-intensity"></div>
                            <div class="confidence-bar">
                                <div id="intensity-fill" class="confidence-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="analysis-card">
                            <h4>Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„</h4>
                            <div id="sentiment-confidence"></div>
                            <div class="confidence-bar">
                                <div id="confidence-fill" class="confidence-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div id="sentiment-details"></div>
                </div>

                <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø¢ÙŠØ© -->
                <div id="verse-display" style="display: none;">
                    <h4>ğŸ“– Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</h4>
                    <div class="verse-display">
                        <div class="verse-arabic" id="verse-arabic"></div>
                        <div class="verse-reference" id="verse-reference"></div>
                    </div>
                    
                    <div class="analysis-grid">
                        <div class="analysis-card">
                            <h4>Ø§Ù„Ø´Ø±Ø­</h4>
                            <div id="verse-explanation"></div>
                        </div>
                        <div class="analysis-card">
                            <h4>Ø§Ù„ØªØ¯Ø¨Ø±</h4>
                            <div id="verse-reflection"></div>
                        </div>
                        <div class="analysis-card">
                            <h4>Ø§Ù„Ù†ØµÙŠØ­Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h4>
                            <div id="verse-advice"></div>
                        </div>
                    </div>

                    <div id="verse-topics" style="margin-top: 20px;"></div>
                    <div id="spiritual-guidance" style="margin-top: 20px;"></div>
                </div>

                <!-- Ù…Ø¤Ø´Ø± Ø§Ù„Ø«Ù‚Ø© -->
                <div id="confidence-indicator" style="display: none; text-align: center; margin-top: 20px;">
                    <h4>ğŸ¯ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© ÙÙŠ Ø§Ù„ØªÙˆØµÙŠØ©</h4>
                    <div class="confidence-bar" style="max-width: 400px; margin: 10px auto;">
                        <div id="recommendation-confidence" class="confidence-fill" style="width: 0%"></div>
                    </div>
                    <div id="confidence-text"></div>
                    <div id="source-info" style="margin-top: 10px;"></div>
                </div>
            </div>

            <!-- Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª -->
            <div class="test-section">
                <h2>ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h2>
                <button class="btn btn-warning" onclick="clearLog()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
                <div id="log" class="log-container"></div>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        let isLoading = false;
        let systemStatus = {
            groq: false,
            verse: false,
            sentiment: false
        };

        // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø³Ø¬Ù„
        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `[${timestamp}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
        function clearLog() {
            document.getElementById('log').innerHTML = '';
            addLog('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„', 'info');
        }

        // ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        async function checkSystemHealth() {
            addLog('ğŸ” Ø¨Ø¯Ø¡ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...', 'info');
            
            // ÙØ­Øµ Groq AI
            try {
                addLog('ğŸ¤– ÙØ­Øµ Ø®Ø¯Ù…Ø© Groq AI...', 'info');
                // Ù…Ø­Ø§ÙƒØ§Ø© ÙØ­Øµ Groq AI
                const groqHealthy = await simulateGroqCheck();
                updateStatus('groq', groqHealthy);
                addLog(`âœ… Ø®Ø¯Ù…Ø© Groq AI: ${groqHealthy ? 'Ù…ØªØ§Ø­Ø©' : 'ØºÙŠØ± Ù…ØªØ§Ø­Ø©'}`, groqHealthy ? 'success' : 'error');
            } catch (error) {
                updateStatus('groq', false);
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Groq AI: ${error.message}`, 'error');
            }

            // ÙØ­Øµ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª
            try {
                addLog('ğŸ“– ÙØ­Øµ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠØ©...', 'info');
                const verseHealthy = await simulateVerseCheck();
                updateStatus('verse', verseHealthy);
                addLog(`âœ… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª: ${verseHealthy ? 'Ù…ØªØ§Ø­Ø©' : 'ØºÙŠØ± Ù…ØªØ§Ø­Ø©'}`, verseHealthy ? 'success' : 'error');
            } catch (error) {
                updateStatus('verse', false);
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª: ${error.message}`, 'error');
            }

            // ÙØ­Øµ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
            try {
                addLog('ğŸ§  ÙØ­Øµ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±...', 'info');
                const sentimentHealthy = await simulateSentimentCheck();
                updateStatus('sentiment', sentimentHealthy);
                addLog(`âœ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: ${sentimentHealthy ? 'Ù…ØªØ§Ø­' : 'ØºÙŠØ± Ù…ØªØ§Ø­'}`, sentimentHealthy ? 'success' : 'error');
            } catch (error) {
                updateStatus('sentiment', false);
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: ${error.message}`, 'error');
            }

            addLog('ğŸ Ø§Ù†ØªÙ‡Ù‰ ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù…', 'info');
        }

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©
        function updateStatus(service, isHealthy) {
            const element = document.getElementById(`${service}-status`);
            element.className = `status-indicator ${isHealthy ? 'status-success' : 'status-error'}`;
            element.textContent = isHealthy ? 'âœ… Ù…ØªØ§Ø­' : 'âŒ ØºÙŠØ± Ù…ØªØ§Ø­';
            systemStatus[service] = isHealthy;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ÙØ­Øµ Groq AI
        async function simulateGroqCheck() {
            await new Promise(resolve => setTimeout(resolve, 1000));
            // Ù…Ø­Ø§ÙƒØ§Ø© Ù†Ø¬Ø§Ø­ 80% Ù…Ù† Ø§Ù„ÙˆÙ‚Øª
            return Math.random() > 0.2;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ÙØ­Øµ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¢ÙŠØ§Øª
        async function simulateVerseCheck() {
            await new Promise(resolve => setTimeout(resolve, 800));
            return Math.random() > 0.1;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ÙØ­Øµ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
        async function simulateSentimentCheck() {
            await new Promise(resolve => setTimeout(resolve, 600));
            return Math.random() > 0.15;
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹
        async function quickTest(mood) {
            document.getElementById('customMood').value = mood;
            await testCustomMood();
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø®ØµØµ
        async function testCustomMood() {
            if (isLoading) return;

            const mood = document.getElementById('customMood').value.trim();
            if (!mood) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø­Ø§Ù„ØªÙƒ Ø§Ù„Ù†ÙØ³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            isLoading = true;
            const testBtn = document.getElementById('testBtn');
            testBtn.disabled = true;
            testBtn.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©... <div class="loading"></div>';

            addLog(`ğŸ¯ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©: "${mood.substring(0, 50)}..."`, 'info');

            try {
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
                addLog('ğŸ§  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±...', 'info');
                const sentimentResult = await analyzeSentiment(mood);
                displaySentimentAnalysis(sentimentResult);
                addLog(`âœ… ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: ${sentimentResult.sentiment}`, 'success');

                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ©
                addLog('ğŸ“– Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©...', 'info');
                const verseResult = await getSmartVerse(mood, sentimentResult);
                displayVerseRecommendation(verseResult);
                addLog(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ©: ${verseResult.verse.reference}`, 'success');

                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                document.getElementById('results').classList.add('show');
                addLog('ğŸ‰ ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­!', 'success');

            } catch (error) {
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}`, 'error');
                alert(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`);
            } finally {
                isLoading = false;
                testBtn.disabled = false;
                testBtn.innerHTML = 'ğŸš€ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©';
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± ÙÙ‚Ø·
        async function testSentimentOnly() {
            const mood = document.getElementById('customMood').value.trim();
            if (!mood) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø­Ø§Ù„ØªÙƒ Ø§Ù„Ù†ÙØ³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            addLog(`ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± ÙÙ‚Ø·: "${mood.substring(0, 50)}..."`, 'info');

            try {
                const sentimentResult = await analyzeSentiment(mood);
                displaySentimentAnalysis(sentimentResult);
                document.getElementById('results').classList.add('show');
                addLog('âœ… ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø¨Ù†Ø¬Ø§Ø­', 'success');
            } catch (error) {
                addLog(`âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: ${error.message}`, 'error');
                alert(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`);
            }
        }

        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø± (Ù…Ø­Ø§ÙƒØ§Ø©)
        async function analyzeSentiment(text) {
            await new Promise(resolve => setTimeout(resolve, 1500));

            // ØªØ­Ù„ÙŠÙ„ Ø¨Ø³ÙŠØ· Ù„Ù„Ù…Ø´Ø§Ø¹Ø±
            const lowerText = text.toLowerCase();
            let sentiment = 'neutral';
            let emotions = [];
            let intensity = 0.5;

            if (lowerText.includes('Ø­Ø²Ù†') || lowerText.includes('Ø­Ø²ÙŠÙ†') || lowerText.includes('Ù…ÙƒØªØ¦Ø¨')) {
                sentiment = 'negative';
                emotions = ['Ø­Ø²Ù†', 'ÙƒØ¢Ø¨Ø©'];
                intensity = 0.8;
            } else if (lowerText.includes('Ù‚Ù„Ù‚') || lowerText.includes('Ø®ÙˆÙ') || lowerText.includes('ØªÙˆØªØ±')) {
                sentiment = 'negative';
                emotions = ['Ù‚Ù„Ù‚', 'ØªÙˆØªØ±'];
                intensity = 0.7;
            } else if (lowerText.includes('Ø´ÙƒØ±') || lowerText.includes('Ù…Ù…ØªÙ†') || lowerText.includes('Ø³Ø¹ÙŠØ¯')) {
                sentiment = 'positive';
                emotions = ['Ø´ÙƒØ±', 'Ø§Ù…ØªÙ†Ø§Ù†'];
                intensity = 0.9;
            } else if (lowerText.includes('ØºØ¶Ø¨') || lowerText.includes('ØºØ§Ø¶Ø¨') || lowerText.includes('Ø¥Ø­Ø¨Ø§Ø·')) {
                sentiment = 'negative';
                emotions = ['ØºØ¶Ø¨', 'Ø¥Ø­Ø¨Ø§Ø·'];
                intensity = 0.8;
            }

            return {
                sentiment,
                emotions,
                intensity,
                keywords: emotions,
                confidence: 0.85
            };
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢ÙŠØ© Ø°ÙƒÙŠØ© (Ù…Ø­Ø§ÙƒØ§Ø©)
        async function getSmartVerse(mood, sentimentResult) {
            await new Promise(resolve => setTimeout(resolve, 2000));

            // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¢ÙŠØ§Øª Ù…Ø­Ø§ÙƒØ§Ø©
            const verses = {
                negative: [
                    {
                        verse: {
                            arabic: 'ÙˆÙØ¨ÙØ´ÙÙ‘Ø±Ù Ø§Ù„ØµÙÙ‘Ø§Ø¨ÙØ±ÙÙŠÙ†Ù Û Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø¥ÙØ°ÙØ§ Ø£ÙØµÙØ§Ø¨ÙØªÙ’Ù‡ÙÙ… Ù…ÙÙ‘ØµÙÙŠØ¨ÙØ©ÙŒ Ù‚ÙØ§Ù„ÙÙˆØ§ Ø¥ÙÙ†ÙÙ‘Ø§ Ù„ÙÙ„ÙÙ‘Ù‡Ù ÙˆÙØ¥ÙÙ†ÙÙ‘Ø§ Ø¥ÙÙ„ÙÙŠÙ’Ù‡Ù Ø±ÙØ§Ø¬ÙØ¹ÙÙˆÙ†Ù',
                            translation: 'ÙˆØ¨Ø´Ø± Ø§Ù„ØµØ§Ø¨Ø±ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ø¥Ø°Ø§ Ø£ØµØ§Ø¨ØªÙ‡Ù… Ù…ØµÙŠØ¨Ø© Ù‚Ø§Ù„ÙˆØ§ Ø¥Ù†Ø§ Ù„Ù„Ù‡ ÙˆØ¥Ù†Ø§ Ø¥Ù„ÙŠÙ‡ Ø±Ø§Ø¬Ø¹ÙˆÙ†',
                            surah: 'Ø§Ù„Ø¨Ù‚Ø±Ø©',
                            ayah: 156,
                            reference: 'Ø§Ù„Ø¨Ù‚Ø±Ø©: 156'
                        },
                        explanation: 'Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ© ØªØ°ÙƒØ±Ù†Ø§ Ø¨Ø£Ù† Ø§Ù„ØµØ¨Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„Ø§Ø¡ Ù…Ù† ØµÙØ§Øª Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†ØŒ ÙˆØ£Ù† ÙƒÙ„ Ù…Ø§ ÙŠØµÙŠØ¨Ù†Ø§ Ù‡Ùˆ Ù…Ù† Ù‚Ø¯Ø± Ø§Ù„Ù„Ù‡',
                        reflection: 'Ø¹Ù†Ø¯Ù…Ø§ ØªØ´Ø¹Ø± Ø¨Ø§Ù„Ø­Ø²Ù†ØŒ ØªØ°ÙƒØ± Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ø§Ø¨ØªÙ„Ø§Ø¡ Ù…Ø¤Ù‚Øª ÙˆØ£Ù† Ø§Ù„Ù„Ù‡ Ù…Ø¹Ùƒ. Ù‚Ù„ "Ø¥Ù†Ø§ Ù„Ù„Ù‡ ÙˆØ¥Ù†Ø§ Ø¥Ù„ÙŠÙ‡ Ø±Ø§Ø¬Ø¹ÙˆÙ†" ÙˆØ§Ø³ØªØ´Ø¹Ø± Ø§Ù„Ø³ÙƒÙŠÙ†Ø©',
                        practicalAdvice: 'Ø§Ù‚Ø±Ø£ Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø­Ø²Ù† ÙˆØ§Ø³ØªØ´Ø¹Ø± Ø£Ù† Ø§Ù„Ù„Ù‡ ÙŠØ®ØªØ¨Ø±Ùƒ Ù„ÙŠØ±ÙØ¹ Ø¯Ø±Ø¬ØªÙƒ',
                        relatedTopics: ['Ø§Ù„ØµØ¨Ø±', 'Ø§Ù„Ø§Ø¨ØªÙ„Ø§Ø¡', 'Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù‡'],
                        spiritualGuidance: ['Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ø§Ø³ØªØºÙØ§Ø±', 'Ø§Ø¯Ø¹ Ø§Ù„Ù„Ù‡ Ø¨Ø§Ù„ÙØ±Ø¬', 'ØªØ°ÙƒØ± Ø£Ù† Ù…Ø¹ Ø§Ù„Ø¹Ø³Ø± ÙŠØ³Ø±Ø§Ù‹']
                    },
                    {
                        verse: {
                            arabic: 'Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø¢Ù…ÙÙ†ÙÙˆØ§ ÙˆÙØªÙØ·Ù’Ù…ÙØ¦ÙÙ†ÙÙ‘ Ù‚ÙÙ„ÙÙˆØ¨ÙÙ‡ÙÙ… Ø¨ÙØ°ÙÙƒÙ’Ø±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Û— Ø£ÙÙ„ÙØ§ Ø¨ÙØ°ÙÙƒÙ’Ø±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ØªÙØ·Ù’Ù…ÙØ¦ÙÙ†ÙÙ‘ Ø§Ù„Ù’Ù‚ÙÙ„ÙÙˆØ¨Ù',
                            translation: 'Ø§Ù„Ø°ÙŠÙ† Ø¢Ù…Ù†ÙˆØ§ ÙˆØªØ·Ù…Ø¦Ù† Ù‚Ù„ÙˆØ¨Ù‡Ù… Ø¨Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ Ø£Ù„Ø§ Ø¨Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ ØªØ·Ù…Ø¦Ù† Ø§Ù„Ù‚Ù„ÙˆØ¨',
                            surah: 'Ø§Ù„Ø±Ø¹Ø¯',
                            ayah: 28,
                            reference: 'Ø§Ù„Ø±Ø¹Ø¯: 28'
                        },
                        explanation: 'Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ Ù‡Ùˆ Ø§Ù„Ø¯ÙˆØ§Ø¡ Ø§Ù„Ø´Ø§ÙÙŠ Ù„Ù„Ù‚Ù„ÙˆØ¨ Ø§Ù„Ù…Ø¶Ø·Ø±Ø¨Ø© ÙˆØ§Ù„Ù†ÙÙˆØ³ Ø§Ù„Ù‚Ù„Ù‚Ø©',
                        reflection: 'Ø§Ø¬Ø¹Ù„ Ù„Ø³Ø§Ù†Ùƒ Ø±Ø·Ø¨Ø§Ù‹ Ø¨Ø°ÙƒØ± Ø§Ù„Ù„Ù‡. Ø³Ø¨Ø­ Ø§Ù„Ù„Ù‡ØŒ Ø§Ø­Ù…Ø¯Ù‡ØŒ ÙˆØ§Ø³ØªØºÙØ±Ù‡. Ø³ØªØ¬Ø¯ Ø§Ù„Ø³ÙƒÙŠÙ†Ø© ØªÙ…Ù„Ø£ Ù‚Ù„Ø¨Ùƒ',
                        practicalAdvice: 'Ø§Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ ÙƒØ«ÙŠØ±Ø§Ù‹ØŒ Ø®Ø§ØµØ© Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ù‚Ù„Ù‚ Ø£Ùˆ Ø§Ù„ØªÙˆØªØ±',
                        relatedTopics: ['Ø°ÙƒØ± Ø§Ù„Ù„Ù‡', 'Ø§Ù„Ø³ÙƒÙŠÙ†Ø©', 'Ø§Ù„Ø·Ù…Ø£Ù†ÙŠÙ†Ø©'],
                        spiritualGuidance: ['Ø³Ø¨Ø­ Ø§Ù„Ù„Ù‡ 100 Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹', 'Ø§Ø­Ù…Ø¯ Ø§Ù„Ù„Ù‡ Ø¹Ù„Ù‰ ÙƒÙ„ Ø­Ø§Ù„', 'Ø§Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡ ÙÙŠ ÙƒÙ„ ÙˆÙ‚Øª']
                    }
                ],
                positive: [
                    {
                        verse: {
                            arabic: 'ÙˆÙØ¥ÙØ°Ù’ ØªÙØ£ÙØ°ÙÙ‘Ù†Ù Ø±ÙØ¨ÙÙ‘ÙƒÙÙ…Ù’ Ù„ÙØ¦ÙÙ† Ø´ÙÙƒÙØ±Ù’ØªÙÙ…Ù’ Ù„ÙØ£ÙØ²ÙÙŠØ¯ÙÙ†ÙÙ‘ÙƒÙÙ…Ù’ Û– ÙˆÙÙ„ÙØ¦ÙÙ† ÙƒÙÙÙØ±Ù’ØªÙÙ…Ù’ Ø¥ÙÙ†ÙÙ‘ Ø¹ÙØ°ÙØ§Ø¨ÙÙŠ Ù„ÙØ´ÙØ¯ÙÙŠØ¯ÙŒ',
                            translation: 'ÙˆØ¥Ø° ØªØ£Ø°Ù† Ø±Ø¨ÙƒÙ… Ù„Ø¦Ù† Ø´ÙƒØ±ØªÙ… Ù„Ø£Ø²ÙŠØ¯Ù†ÙƒÙ… ÙˆÙ„Ø¦Ù† ÙƒÙØ±ØªÙ… Ø¥Ù† Ø¹Ø°Ø§Ø¨ÙŠ Ù„Ø´Ø¯ÙŠØ¯',
                            surah: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',
                            ayah: 7,
                            reference: 'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…: 7'
                        },
                        explanation: 'Ø§Ù„Ø´ÙƒØ± ÙŠØ²ÙŠØ¯ Ø§Ù„Ù†Ø¹Ù…ØŒ ÙˆÙ‡Ùˆ Ø³Ø¨Ø¨ ÙÙŠ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† ÙØ¶Ù„ Ø§Ù„Ù„Ù‡ ÙˆÙƒØ±Ù…Ù‡',
                        reflection: 'Ø§Ø´ÙƒØ± Ø§Ù„Ù„Ù‡ Ø¹Ù„Ù‰ ÙƒÙ„ Ù†Ø¹Ù…Ø© ØµØºÙŠØ±Ø© ÙˆÙƒØ¨ÙŠØ±Ø©. Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø´ÙƒØ± Ø¹Ø§Ø¯Ø© ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ø³ØªØ´Ø¹Ø± Ø§Ù„Ø¨Ø±ÙƒØ© ÙÙŠ Ø­ÙŠØ§ØªÙƒ',
                        practicalAdvice: 'Ø§ÙƒØªØ¨ 3 Ø£Ø´ÙŠØ§Ø¡ ØªØ´ÙƒØ± Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙ‡Ø§ ÙƒÙ„ ÙŠÙˆÙ…',
                        relatedTopics: ['Ø§Ù„Ø´ÙƒØ±', 'Ø§Ù„Ù†Ø¹Ù…', 'Ø§Ù„Ø¨Ø±ÙƒØ©'],
                        spiritualGuidance: ['Ø§Ø­Ù…Ø¯ Ø§Ù„Ù„Ù‡ ÙÙŠ ÙƒÙ„ ØµØ¨Ø§Ø­ ÙˆÙ…Ø³Ø§Ø¡', 'Ø§Ø´ÙƒØ± Ø§Ù„Ù„Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¹Ù… Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© ÙˆØ§Ù„Ø¨Ø§Ø·Ù†Ø©', 'Ø§Ø¯Ø¹ Ø§Ù„Ù„Ù‡ Ø£Ù† ÙŠØ²ÙŠØ¯Ùƒ Ù…Ù† ÙØ¶Ù„Ù‡']
                    }
                ],
                neutral: [
                    {
                        verse: {
                            arabic: 'ÙˆÙÙ…ÙÙ† ÙŠÙØªÙÙ‘Ù‚Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙŠÙØ¬Ù’Ø¹ÙÙ„ Ù„ÙÙ‘Ù‡Ù Ù…ÙØ®Ù’Ø±ÙØ¬Ù‹Ø§ Û ÙˆÙÙŠÙØ±Ù’Ø²ÙÙ‚Ù’Ù‡Ù Ù…ÙÙ†Ù’ Ø­ÙÙŠÙ’Ø«Ù Ù„ÙØ§ ÙŠÙØ­Ù’ØªÙØ³ÙØ¨Ù',
                            translation: 'ÙˆÙ…Ù† ÙŠØªÙ‚ Ø§Ù„Ù„Ù‡ ÙŠØ¬Ø¹Ù„ Ù„Ù‡ Ù…Ø®Ø±Ø¬Ø§Ù‹ ÙˆÙŠØ±Ø²Ù‚Ù‡ Ù…Ù† Ø­ÙŠØ« Ù„Ø§ ÙŠØ­ØªØ³Ø¨',
                            surah: 'Ø§Ù„Ø·Ù„Ø§Ù‚',
                            ayah: 2,
                            reference: 'Ø§Ù„Ø·Ù„Ø§Ù‚: 2-3'
                        },
                        explanation: 'Ø§Ù„ØªÙ‚ÙˆÙ‰ Ù‡ÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„ÙƒÙ„ Ø®ÙŠØ±ØŒ ÙˆÙ…Ù† ÙŠØªÙ‚ Ø§Ù„Ù„Ù‡ ÙŠØ¬Ø¹Ù„ Ù„Ù‡ Ù…Ù† ÙƒÙ„ Ø¶ÙŠÙ‚ Ù…Ø®Ø±Ø¬Ø§Ù‹',
                        reflection: 'Ø§ØªÙ‚ Ø§Ù„Ù„Ù‡ ÙÙŠ ÙƒÙ„ Ø£Ù…ÙˆØ±ÙƒØŒ ÙˆØ§Ø¹Ù„Ù… Ø£Ù† Ø§Ù„Ù„Ù‡ Ø³ÙŠØ¬Ø¹Ù„ Ù„Ùƒ Ù…Ù† ÙƒÙ„ Ù‡Ù… ÙØ±Ø¬Ø§Ù‹ ÙˆÙ…Ù† ÙƒÙ„ Ø¶ÙŠÙ‚ Ù…Ø®Ø±Ø¬Ø§Ù‹',
                        practicalAdvice: 'Ø§Ø¬Ø¹Ù„ ØªÙ‚ÙˆÙ‰ Ø§Ù„Ù„Ù‡ Ù†ØµØ¨ Ø¹ÙŠÙ†ÙŠÙƒ ÙÙŠ ÙƒÙ„ Ù‚Ø±Ø§Ø± ØªØªØ®Ø°Ù‡',
                        relatedTopics: ['Ø§Ù„ØªÙ‚ÙˆÙ‰', 'Ø§Ù„ØªÙˆÙƒÙ„', 'Ø§Ù„Ø±Ø²Ù‚'],
                        spiritualGuidance: ['Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù„Ù‡ ÙÙŠ Ø§Ù„Ø³Ø± ÙˆØ§Ù„Ø¹Ù„Ù†', 'ØªÙˆÙƒÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‡ ÙÙŠ ÙƒÙ„ Ø£Ù…ÙˆØ±Ùƒ', 'Ø§Ø¹Ù„Ù… Ø£Ù† Ø§Ù„Ù„Ù‡ Ù„Ø§ ÙŠØ¶ÙŠØ¹ Ø£Ø¬Ø± Ø§Ù„Ù…ØªÙ‚ÙŠÙ†']
                    }
                ]
            };

            const categoryVerses = verses[sentimentResult.sentiment] || verses.neutral;
            const selectedVerse = categoryVerses[Math.floor(Math.random() * categoryVerses.length)];

            // Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ·Ø§Ø¨Ù‚
            const confidence = sentimentResult.sentiment !== 'neutral' ? 0.95 : 0.75;

            return {
                ...selectedVerse,
                confidence,
                sentiment: sentimentResult.sentiment,
                emotionalCategory: getEmotionalCategory(sentimentResult.sentiment)
            };
        }

        // ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
        function getEmotionalCategory(sentiment) {
            switch (sentiment) {
                case 'positive': return 'Ø´ÙƒØ± ÙˆØ§Ù…ØªÙ†Ø§Ù†';
                case 'negative': return 'Ø­Ø§Ø¬Ø© Ù„Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ø³Ù„ÙˆØ§Ù†';
                default: return 'Ø­Ø§Ù„Ø© Ù…ØªÙˆØ§Ø²Ù†Ø©';
            }
        }

        // Ø¹Ø±Ø¶ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
        function displaySentimentAnalysis(result) {
            document.getElementById('sentiment-analysis').style.display = 'block';
            
            // Ù†ÙˆØ¹ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
            const sentimentType = document.getElementById('sentiment-type');
            const sentimentClass = result.sentiment === 'positive' ? 'status-success' : 
                                 result.sentiment === 'negative' ? 'status-error' : 'status-warning';
            const sentimentText = result.sentiment === 'positive' ? 'ğŸ˜Š Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©' :
                                result.sentiment === 'negative' ? 'ğŸ˜” Ø³Ù„Ø¨ÙŠØ©' : 'ğŸ˜ Ù…ØªÙˆØ§Ø²Ù†Ø©';
            sentimentType.innerHTML = `<span class="status-indicator ${sentimentClass}">${sentimentText}</span>`;

            // Ø´Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
            const intensityPercent = Math.round(result.intensity * 100);
            document.getElementById('sentiment-intensity').textContent = `${intensityPercent}%`;
            document.getElementById('intensity-fill').style.width = `${intensityPercent}%`;

            // Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„
            const confidencePercent = Math.round(result.confidence * 100);
            document.getElementById('sentiment-confidence').textContent = `${confidencePercent}%`;
            document.getElementById('confidence-fill').style.width = `${confidencePercent}%`;

            // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©
            const details = document.getElementById('sentiment-details');
            details.innerHTML = `
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <strong>Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ù…ÙƒØªØ´ÙØ©:</strong> ${result.emotions.join(', ')}<br>
                    <strong>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©:</strong> ${result.keywords.join(', ')}
                </div>
            `;
        }

        // Ø¹Ø±Ø¶ ØªÙˆØµÙŠØ© Ø§Ù„Ø¢ÙŠØ©
        function displayVerseRecommendation(result) {
            document.getElementById('verse-display').style.display = 'block';
            document.getElementById('confidence-indicator').style.display = 'block';

            // Ø¹Ø±Ø¶ Ø§Ù„Ø¢ÙŠØ©
            document.getElementById('verse-arabic').textContent = result.verse.arabic;
            document.getElementById('verse-reference').textContent = result.verse.reference;

            // Ø§Ù„Ø´Ø±Ø­ ÙˆØ§Ù„ØªØ¯Ø¨Ø± ÙˆØ§Ù„Ù†ØµÙŠØ­Ø©
            document.getElementById('verse-explanation').textContent = result.explanation;
            document.getElementById('verse-reflection').textContent = result.reflection;
            document.getElementById('verse-advice').textContent = result.practicalAdvice;

            // Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø°Ø§Øª Ø§Ù„ØµÙ„Ø©
            const topicsHtml = result.relatedTopics.map(topic => 
                `<span class="status-indicator status-success" style="margin: 2px;">${topic}</span>`
            ).join('');
            document.getElementById('verse-topics').innerHTML = `
                <h4>ğŸ·ï¸ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø°Ø§Øª Ø§Ù„ØµÙ„Ø©</h4>
                <div>${topicsHtml}</div>
            `;

            // Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ø±ÙˆØ­ÙŠØ©
            const guidanceHtml = result.spiritualGuidance.map(guidance => 
                `<li style="margin-bottom: 5px;">${guidance}</li>`
            ).join('');
            document.getElementById('spiritual-guidance').innerHTML = `
                <h4>ğŸ¤² Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø±ÙˆØ­ÙŠØ©</h4>
                <ul style="text-align: right; padding-right: 20px;">${guidanceHtml}</ul>
            `;

            // Ù…Ø¤Ø´Ø± Ø§Ù„Ø«Ù‚Ø©
            const confidencePercent = Math.round(result.confidence * 100);
            document.getElementById('recommendation-confidence').style.width = `${confidencePercent}%`;
            document.getElementById('confidence-text').textContent = `${confidencePercent}%`;
            
            const sourceText = result.confidence > 0.9 ? 
                'ğŸ¤– Ù…ÙÙˆÙ„Ø¯Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªØ®ØµØµ' : 
                'ğŸ“š Ù…Ø®ØªØ§Ø±Ø© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©';
            document.getElementById('source-info').innerHTML = `
                <span class="status-indicator ${result.confidence > 0.9 ? 'status-success' : 'status-warning'}">
                    ${sourceText}
                </span>
            `;
        }

        // ØªØ´ØºÙŠÙ„ ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', function() {
            addLog('ğŸš€ ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'info');
            addLog('ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'info');
            checkSystemHealth();
        });
    </script>
</body>
</html>
